<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use Case Subway Map</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* bg-gray-900 */
        }

        /* Main container for the map and info panel */
        .main-container {
            display: flex;
            flex-direction: column;
            lg:flex-direction: row;
            height: 100vh;
            width: 100%;
            padding: 1rem;
            gap: 1rem;
        }

        @media (min-width: 1024px) {
            .main-container {
                flex-direction: row;
                padding: 2rem;
                gap: 2rem;
            }
        }

        /* The map area */
        .map-container {
            position: relative;
            flex-grow: 1;
            background-color: #1F2937; /* bg-gray-800 */
            border-radius: 0.75rem; /* rounded-xl */
            border: 1px solid #374151; /* border-gray-700 */
            overflow: hidden;
            min-height: 500px;
        }
        
        /* The info panel on the side */
        .info-panel {
            flex-shrink: 0;
            width: 100%;
            lg:width: 350px;
            background-color: #1F2937; /* bg-gray-800 */
            border-radius: 0.75rem; /* rounded-xl */
            border: 1px solid #374151; /* border-gray-700 */
            padding: 1.5rem;
            color: #D1D5DB; /* text-gray-300 */
            transition: all 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        @media (min-width: 1024px) {
            .info-panel {
                width: 350px;
            }
        }

        /* Style for the subway lines */
        .line {
            position: absolute;
            background-color: currentColor;
            height: 8px; /* Thickness of the line */
            border-radius: 4px;
            transform-origin: left center;
            z-index: 1;
        }

        /* Style for the stations */
        .station {
            position: absolute;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: #111827; /* bg-gray-900 */
            border: 4px solid;
            cursor: pointer;
            z-index: 2;
            transform: translate(-50%, -50%); /* Center the station on its coordinates */
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .station:hover {
            transform: translate(-50%, -50%) scale(1.3);
            box-shadow: 0 0 15px currentColor;
        }

        /* Inner circle for ALL stations */
        .station-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background-color: #F3F4F6; /* Default: white */
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
        }
        
        /* Style for the station labels (numbers) */
        .station-label {
            color: #111827; /* Default: black text */
            font-size: 12px;
            font-weight: 700;
            z-index: 3;
            pointer-events: none; /* Allows clicks to pass through to the station */
            transition: color 0.2s ease;
        }
        
        /* Override styles for INTERCHANGE stations */
        .station.interchange .station-inner {
            background-color: #111827; /* Black background */
        }

        .station.interchange .station-label {
            color: #F3F4F6; /* White text */
        }
        
        /* Specific line colors */
        .line-blue { border-color: #3B82F6; color: #3B82F6; } /* blue-500 */
        .line-green { border-color: #22C55E; color: #22C55E; } /* green-500 */
        .line-orange { border-color: #F97316; color: #F97316; } /* orange-500 */

    </style>
</head>
<body>

    <div class="main-container">
        <!-- The map will be rendered here -->
        <div id="map" class="map-container">
            <!-- The map content, including the legend, is generated by JS -->
        </div>

        <!-- The info panel that shows details on hover -->
        <div id="info-panel" class="info-panel">
            <div id="info-content">
                <h2 id="info-title" class="text-xl font-bold text-white mb-2">Hover over a station</h2>
                <p id="info-description" class="text-gray-400">Select a use case on the map to see its details here.</p>
            </div>
        </div>
    </div>

    <script>
        // --- Use Case Data --- 
        const useCases = [
            { id: 0, title: "Social Listening and Natural Language Processing", description: "How Graph Theory and AI Revolutionize Brand Advocacy", url: "https://moria-ai-labs.github.io/use_case1/", lines: ['nlp', 'graph'] },
            { id: 1, title: "AB Testing Reimagined", description: "Unlocking Customer Insights: A Graph-Powered Approach to A/B Testing at Lonely Mountain Online Bank", url: "https://moria-ai-labs.github.io/use_case2/", lines: ['testing', 'graph'] },
            { id: 2, title: "Unsupervised Learning - validation", description: "How might we interpret and validate clusterings in a visual way, leveraging 3D plots?", url: "https://moria-ai-labs.github.io/use_case3/", lines: ['testing'] },
            { id: 3, title: "Network Path Optimization", description: "How might we define a winning strategy for the gold grabbing game in a tree?", url: "https://moria-ai-labs.github.io/use_case4/", lines: ['graph'] },
            { id: 4, title: "Natural Language Processing - edit distance", description: "How might we visualize the edit distance procedure?", url: "https://moria-ai-labs.github.io/use_case5/", lines: ['nlp'] },
            { id: 5, title: "Unsupervised Learning - understanding", description: "How might we visualize kNN algorithm in a very intuitive way?.", url: "https://moria-ai-labs.github.io/use_case6/", lines: ['testing'] },
            { id: 6, title: "Graph Representation of Data Processing", description: "How might we visualize CTEs in an intuitive way?", url: "https://moria-ai-labs.github.io/use_case7/", lines: ['graph'] },
            { id: 7, title: "Human Design", description: "An experiment on digital art", url: "https://moria-ai-labs.github.io/use_case8/", lines: ['graph'] },
            { id: 8, title: "AB Testing - understanding", description: "How might we visualize AB tests in an intuitive way?", url: "https://moria-ai-labs.github.io/use_case9/", lines: ['testing'] },
            { id: 9, "title": "Probability and Random Walks Reimagined", "description": "How might we understand probability and statistics with a simple Galton Board?", "url": "https://moria-ai-labs.github.io/use_case10/", lines: ['graph'] },
            { id: 10, title: "Agentic Search for small businesses", description: "How might we bring visibility to small and minority-owned businesses in the Agentic Era", url: "https://moria-ai-labs.github.io/use_case11/", lines: ['nlp'] },
            { id: 11, title: "Natural Language Processing - typo correction", description: "How might we understand how typos affect our written language?", url: "https://moria-ai-labs.github.io/use_case12/", lines: ['nlp'] }
        ];

        // --- Thematic Line Definitions ---
        const linesConfig = {
            'nlp': { name: 'NLP', colorClass: 'line-blue', stationIds: [11, 4, 0, 10] },
            'testing': { name: 'Testing & Learning', colorClass: 'line-green', stationIds: [8, 1, 5, 2] },
            'graph': { name: 'Graph & Data Viz', colorClass: 'line-orange', stationIds: [3, 6, 0, 1, 9, 7] }
        };

        // --- Station Positions (in percentages) ---
        const positions = {
            3: [10, 50], 6: [25, 50], 0: [40, 50], 1: [60, 50], 9: [75, 50], 7: [90, 50],
            11: [40, 20], 4: [40, 35], 10: [40, 65],
            8: [60, 35], 5: [60, 65], 2: [60, 80]
        };
        
        const mapContainer = document.getElementById('map');
        const infoTitle = document.getElementById('info-title');
        const infoDescription = document.getElementById('info-description');

        /**
         * Creates a line element between two points.
         */
        function createLine(p1, p2, colorClass) {
            const mapWidth = mapContainer.offsetWidth;
            const mapHeight = mapContainer.offsetHeight;
            const x1 = (p1[0] / 100) * mapWidth, y1 = (p1[1] / 100) * mapHeight;
            const x2 = (p2[0] / 100) * mapWidth, y2 = (p2[1] / 100) * mapHeight;
            const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            const line = document.createElement('div');
            line.className = `line ${colorClass}`;
            line.style.width = `${length}px`;
            line.style.left = `${x1}px`;
            line.style.top = `${y1}px`;
            line.style.transform = `rotate(${angle}deg)`;
            mapContainer.appendChild(line);
        }

        /**
         * Renders all the elements on the map.
         */
        function renderMap() {
            // Clear previous map elements
            mapContainer.innerHTML = '';

            // Draw lines first so they appear underneath the stations
            for (const lineKey in linesConfig) {
                const line = linesConfig[lineKey];
                for (let i = 0; i < line.stationIds.length - 1; i++) {
                    const p1 = positions[line.stationIds[i]];
                    const p2 = positions[line.stationIds[i+1]];
                    createLine(p1, p2, line.colorClass);
                }
            }

            // Draw stations and their number labels
            useCases.forEach(useCase => {
                const pos = positions[useCase.id];
                const primaryLine = linesConfig[useCase.lines[0]];
                const isInterchange = useCase.lines.length > 1;

                const station = document.createElement('a');
                station.href = useCase.url;
                station.target = "_blank";
                station.rel = "noopener noreferrer";
                station.className = `station ${primaryLine.colorClass}`;
                station.style.left = `${pos[0]}%`;
                station.style.top = `${pos[1]}%`;

                // Add interchange class if applicable
                if (isInterchange) {
                    station.classList.add('interchange');
                }

                const label = document.createElement('span');
                label.className = 'station-label';
                label.textContent = useCase.id + 1;

                // Create an inner dot for ALL stations for a consistent look
                const innerDot = document.createElement('div');
                innerDot.className = 'station-inner';
                innerDot.appendChild(label); // Number goes inside the inner dot
                station.appendChild(innerDot);
                
                station.addEventListener('mouseover', () => {
                    infoTitle.textContent = `${useCase.id + 1}. ${useCase.title}`;
                    infoDescription.textContent = useCase.description;
                    station.style.borderColor = 'white';
                });
                station.addEventListener('mouseout', () => {
                    station.style.borderColor = '';
                });

                mapContainer.appendChild(station);
            });

            // Draw the legend
            const legendContainer = document.createElement('div');
            legendContainer.className = 'absolute bottom-4 right-4 bg-gray-900 bg-opacity-80 p-4 rounded-lg text-white text-sm shadow-lg';
            legendContainer.innerHTML = '<h3 class="font-bold mb-2 text-base">Lines</h3>';
            const legendList = document.createElement('ul');
            legendList.className = 'space-y-2';

            for (const lineKey in linesConfig) {
                const line = linesConfig[lineKey];
                const listItem = document.createElement('li');
                listItem.className = 'flex items-center';
                listItem.innerHTML = `
                    <span class="w-4 h-1.5 rounded-full mr-3 ${line.colorClass}" style="background-color: currentColor;"></span>
                    <span>${line.name}</span>
                `;
                legendList.appendChild(listItem);
            }
            legendContainer.appendChild(legendList);
            mapContainer.appendChild(legendContainer);
        }
        
        window.onload = renderMap;
        let resizeTimer;
        window.onresize = () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(renderMap, 100);
        };
    </script>
</body>
</html>
