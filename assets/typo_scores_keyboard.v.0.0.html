<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keyboard Typo Heatmap</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #111827; /* bg-gray-900 */
        }
        .keyboard {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 20px;
            background-color: #1f2937; /* bg-gray-800 */
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05), inset 0 2px 4px 0 rgba(255,255,255,0.05);
            border: 1px solid #374151; /* border-gray-700 */
        }
        .key-row {
            display: flex;
            justify-content: center;
            gap: 8px;
        }
        .key {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 500;
            color: #d1d5db; /* text-gray-300 */
            background-color: #374151; /* bg-gray-700 */
            border-radius: 6px;
            border: 1px solid #4b5563; /* border-gray-600 */
            border-bottom-width: 3px;
            transition: all 0.1s ease-in-out;
            position: relative;
            cursor: pointer;
            user-select: none;
        }
        .key:not(.disabled):hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
        }
        /* Style for disabled (non-letter) keys */
        .key.disabled {
            background-color: #374151 !important; /* bg-gray-700 */
            border-color: #4b5563 !important; /* border-gray-600 */
            color: #6b7280; /* text-gray-500 */
            cursor: default;
        }
        .key-sm { width: 50px; height: 50px; }
        .key-md { width: 70px; height: 50px; }
        .key-lg { width: 90px; height: 50px; }
        .key-xl { width: 120px; height: 50px; }
        .key-space { flex-grow: 1; height: 50px; }
        .tooltip {
            position: absolute;
            bottom: 110%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #111827;
            color: white;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            pointer-events: none;
            z-index: 10;
        }
        .key:not(.disabled):hover .tooltip {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body>

<div class="flex flex-col items-center text-white p-4 md:p-8">
    <h1 class="text-3xl font-bold mb-2 text-gray-100">Keyboard Typo Frequency Heatmap</h1>
    <p class="text-gray-400 mb-6">Hover over a letter key to see its typo score.</p>
    
    <div id="keyboard" class="keyboard">
        <!-- Keyboard rows will be generated by JavaScript -->
    </div>

    <div class="flex items-center mt-6 space-x-4">
        <span class="text-gray-400">Low Frequency</span>
        <div class="flex">
            <div class="w-8 h-4 rounded-l" style="background-color: #4ade80;"></div>
            <div class="w-8 h-4" style="background-color: #facc15;"></div>
            <div class="w-8 h-4" style="background-color: #fb923c;"></div>
            <div class="w-8 h-4 rounded-r" style="background-color: #f87171;"></div>
        </div>
        <span class="text-gray-400">High Frequency</span>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // --- DATA ---
        // New typo scores provided by the user.
        const newScores = {'a': 0.4884758364312268, 'b': 0.026022304832713755, 'c': 0.23643122676579925, 'd': 0.3308550185873606, 'e': 1.0, 'f': 0.05427509293680297, 'g': 0.19553903345724907, 'h': 0.12267657992565056, 'i': 0.5263940520446097, 'j': 0.0007434944237918215, 'k': 0.046096654275092935, 'l': 0.324907063197026, 'm': 0.1315985130111524, 'n': 0.3486988847583643, 'o': 0.2550185873605948, 'p': 0.06468401486988848, 'q': 0.001486988847583643, 'r': 0.337546468401487, 's': 0.5747211895910781, 't': 0.32342007434944237, 'u': 0.12713754646840147, 'v': 0.035687732342007436, 'w': 0.041635687732342004, 'x': 0.0007434944237918215, 'y': 0.33605947955390336, 'z': 0.012639405204460967};

        // Process new scores into the required format (uppercase key, integer score 0-100)
        const typoFrequency = {};
        for (const [key, value] of Object.entries(newScores)) {
            typoFrequency[key.toUpperCase()] = Math.round(value * 100);
        }

        // We only consider letters for the max frequency calculation
        const letterFrequencies = Object.values(typoFrequency);
        const maxFrequency = Math.max(...letterFrequencies);

        // --- KEYBOARD LAYOUT ---
        const layout = [
            [
                { key: 'Tilde', code: 'Backquote', label: '~', size: 'sm' }, { key: '1', code: 'Digit1', label: '1', size: 'sm' }, { key: '2', code: 'Digit2', label: '2', size: 'sm' }, { key: '3', code: 'Digit3', label: '3', size: 'sm' }, { key: '4', code: 'Digit4', label: '4', size: 'sm' }, { key: '5', code: 'Digit5', label: '5', size: 'sm' }, { key: '6', code: 'Digit6', label: '6', size: 'sm' }, { key: '7', code: 'Digit7', label: '7', size: 'sm' }, { key: '8', code: 'Digit8', label: '8', size: 'sm' }, { key: '9', code: 'Digit9', label: '9', size: 'sm' }, { key: '0', code: 'Digit0', label: '0', size: 'sm' }, { key: 'Minus', code: 'Minus', label: '-', size: 'sm' }, { key: 'Equal', code: 'Equal', label: '=', size: 'sm' }, { key: 'Backspace', code: 'Backspace', label: 'Backspace', size: 'lg' }
            ],
            [
                { key: 'Tab', code: 'Tab', label: 'Tab', size: 'md' }, { key: 'Q', code: 'KeyQ', label: 'Q', size: 'sm' }, { key: 'W', code: 'KeyW', label: 'W', size: 'sm' }, { key: 'E', code: 'KeyE', label: 'E', size: 'sm' }, { key: 'R', code: 'KeyR', label: 'R', size: 'sm' }, { key: 'T', code: 'KeyT', label: 'T', size: 'sm' }, { key: 'Y', code: 'KeyY', label: 'Y', size: 'sm' }, { key: 'U', code: 'KeyU', label: 'U', size: 'sm' }, { key: 'I', code: 'KeyI', label: 'I', size: 'sm' }, { key: 'O', code: 'KeyO', label: 'O', size: 'sm' }, { key: 'P', code: 'KeyP', label: 'P', size: 'sm' }, { key: 'BracketLeft', code: 'BracketLeft', label: '[', size: 'sm' }, { key: 'BracketRight', code: 'BracketRight', label: ']', size: 'sm' }, { key: 'Backslash', code: 'Backslash', label: '\\', size: 'md' }
            ],
            [
                { key: 'CapsLock', code: 'CapsLock', label: 'Caps Lock', size: 'lg' }, { key: 'A', code: 'KeyA', label: 'A', size: 'sm' }, { key: 'S', code: 'KeyS', label: 'S', size: 'sm' }, { key: 'D', code: 'KeyD', label: 'D', size: 'sm' }, { key: 'F', code: 'KeyF', label: 'F', size: 'sm' }, { key: 'G', code: 'KeyG', label: 'G', size: 'sm' }, { key: 'H', code: 'KeyH', label: 'H', size: 'sm' }, { key: 'J', code: 'KeyJ', label: 'J', size: 'sm' }, { key: 'K', code: 'KeyK', label: 'K', size: 'sm' }, { key: 'L', code: 'KeyL', label: 'L', size: 'sm' }, { key: 'Semicolon', code: 'Semicolon', label: ';', size: 'sm' }, { key: 'Quote', code: 'Quote', label: "'", size: 'sm' }, { key: 'Enter', code: 'Enter', label: 'Enter', size: 'lg' }
            ],
            [
                { key: 'ShiftLeft', code: 'ShiftLeft', label: 'Shift', size: 'xl' }, { key: 'Z', code: 'KeyZ', label: 'Z', size: 'sm' }, { key: 'X', code: 'KeyX', label: 'X', size: 'sm' }, { key: 'C', code: 'KeyC', label: 'C', size: 'sm' }, { key: 'V', code: 'KeyV', label: 'V', size: 'sm' }, { key: 'B', code: 'KeyB', label: 'B', size: 'sm' }, { key: 'N', code: 'KeyN', label: 'N', size: 'sm' }, { key: 'M', code: 'KeyM', label: 'M', size: 'sm' }, { key: 'Comma', code: 'Comma', label: ',', size: 'sm' }, { key: 'Period', code: 'Period', label: '.', size: 'sm' }, { key: 'Slash', code: 'Slash', label: '/', size: 'sm' }, { key: 'ShiftRight', code: 'ShiftRight', label: 'Shift', size: 'xl' }
            ],
            [
                { key: 'ControlLeft', code: 'ControlLeft', label: 'Ctrl', size: 'md' }, { key: 'AltLeft', code: 'AltLeft', label: 'Alt', size: 'md' }, { key: 'Space', code: 'Space', label: '', size: 'space' }, { key: 'AltRight', code: 'AltRight', label: 'Alt', size: 'md' }, { key: 'ControlRight', code: 'ControlRight', label: 'Ctrl', size: 'md' }
            ]
        ];

        const keyboardContainer = document.getElementById('keyboard');

        // --- FUNCTIONS ---

        function getHeatmapColor(frequency, maxFreq) {
            if (maxFreq === 0) return '#4ade80'; // Default color if max is 0
            const value = frequency / maxFreq;
            if (value < 0.25) return lerpColor('#4ade80', '#facc15', value / 0.25);
            if (value < 0.5) return lerpColor('#facc15', '#fb923c', (value - 0.25) / 0.25);
            if (value < 0.75) return lerpColor('#fb923c', '#f87171', (value - 0.5) / 0.25);
            return '#f87171';
        }
        
        function lerpColor(a, b, amount) {
            const ah = parseInt(a.replace(/#/g, ''), 16),
                  ar = ah >> 16, ag = ah >> 8 & 0xff, ab = ah & 0xff,
                  bh = parseInt(b.replace(/#/g, ''), 16),
                  br = bh >> 16, bg = bh >> 8 & 0xff, bb = bh & 0xff,
                  rr = ar + amount * (br - ar),
                  rg = ag + amount * (bg - ag),
                  rb = ab + amount * (bb - ab);
            return '#' + ((1 << 24) + (rr << 16) + (rg << 8) + rb | 0).toString(16).slice(1).toUpperCase();
        }

        // --- RENDER KEYBOARD ---
        layout.forEach(row => {
            const rowDiv = document.createElement('div');
            rowDiv.className = 'key-row';

            row.forEach(keyInfo => {
                const keyDiv = document.createElement('div');
                keyDiv.className = `key key-${keyInfo.size}`;
                keyDiv.id = `key-${keyInfo.code}`;
                
                const isLetter = /^[A-Z]$/.test(keyInfo.key);

                if (isLetter) {
                    const frequency = typoFrequency[keyInfo.key] || 0;
                    const color = getHeatmapColor(frequency, maxFrequency);
                    keyDiv.style.backgroundColor = color;
                    keyDiv.style.borderColor = lerpColor(color, '#000000', 0.3);
                    keyDiv.innerHTML = `
                        ${keyInfo.label}
                        <div class="tooltip">Score: ${frequency}</div>
                    `;
                } else {
                    keyDiv.classList.add('disabled');
                    keyDiv.innerHTML = keyInfo.label;
                }
                
                rowDiv.appendChild(keyDiv);
            });

            keyboardContainer.appendChild(rowDiv);
        });
    });
</script>

</body>
</html>
